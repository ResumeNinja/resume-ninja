{"ast":null,"code":"import _regeneratorRuntime from\"/Users/pulkitkhanna/Downloads/resumen-01/codecanyon-28990151-resumen-multistep-resume-builder/ResumeN/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/pulkitkhanna/Downloads/resumen-01/codecanyon-28990151-resumen-multistep-resume-builder/ResumeN/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import firebase from'firebase';import fire from'../conf/fire';function addResume(userId){localStorage.removeItem(\"currentResumeItem\");var db=firebase.firestore();db.collection(\"users\").doc(userId).collection(\"resumes\").add({}).then(function(docRef){// Adding one into stats Resumes Created\nvar statsRef=db.collection(\"data\").doc(\"stats\");statsRef.update({numberOfResumesCreated:firebase.firestore.FieldValue.increment(1)});setTimeout(function(){localStorage.setItem(\"currentResumeId\",docRef.id);},400);}).then(function(error){return console.log(error);});}export function removeResume(userId,resumeId){var db=firebase.firestore();// Decrement 1 from resumes\nvar statsRef=db.collection(\"data\").doc(\"stats\");statsRef.update({numberOfResumesCreated:firebase.firestore.FieldValue.increment(-1)});db.collection(\"users\").doc(userId).collection(\"resumes\").doc(resumeId).delete().then(function(){}).catch(function(error){console.error(\"Error removing document: \",error);});}// Adding user to firstore \nexport function addUser(userId,firstname,lastname){var db=firebase.firestore();db.collection(\"users\").doc(userId).set({firstname:firstname,lastname:lastname,resumes:\"\",membership:\"basic\"}).then(function(error){return console.log(error);});}// ADD 1 to downloads\nexport function IncrementDownloads(){var db=firebase.firestore();var statsRef=db.collection(\"data\").doc(\"stats\");statsRef.update({numberOfResumesDownloaded:firebase.firestore.FieldValue.increment(1)});}// ADD 1 to users\nexport function IncrementUsers(_x){return _IncrementUsers.apply(this,arguments);}// Getting the name of the current user\nfunction _IncrementUsers(){_IncrementUsers=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(userid){var db,userRef,snapshot,statsRef;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:db=firebase.firestore();userRef=db.collection(\"users\").doc(userid);_context.next=4;return userRef.get();case 4:snapshot=_context.sent;if(!snapshot.exists){statsRef=db.collection(\"data\").doc(\"stats\");statsRef.update({numberOfUsers:firebase.firestore.FieldValue.increment(1)});}case 6:case\"end\":return _context.stop();}}},_callee);}));return _IncrementUsers.apply(this,arguments);}export function getFullName(_x2){return _getFullName.apply(this,arguments);}// Change password\nfunction _getFullName(){_getFullName=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(userId){var firstname,lastname,db,userRef,snapshot;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:firstname=\"\";lastname=\"\";db=firebase.firestore();userRef=db.collection('users').doc(userId);_context2.next=6;return userRef.get();case 6:snapshot=_context2.sent;if(!snapshot.exists){_context2.next=13;break;}firstname=snapshot.data().firstname;lastname=snapshot.data().lastname;return _context2.abrupt(\"return\",{firstname:firstname,lastname:lastname});case 13:console.log(\"notfound\");case 14:case\"end\":return _context2.stop();}}},_callee2);}));return _getFullName.apply(this,arguments);}export function changePassword(_x3){return _changePassword.apply(this,arguments);}function _changePassword(){_changePassword=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(password){var user;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:user=firebase.auth().currentUser;user.updatePassword(password).then(function(){}).catch(function(error){// An error happened.\n});case 2:case\"end\":return _context3.stop();}}},_callee3);}));return _changePassword.apply(this,arguments);}export function getStats(){return _getStats.apply(this,arguments);}// Get ads\nfunction _getStats(){_getStats=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var stats,db,statsRef,snapshot;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:db=firebase.firestore();statsRef=db.collection(\"data\").doc(\"stats\");_context4.next=4;return statsRef.get();case 4:snapshot=_context4.sent;if(!snapshot.exists){_context4.next=8;break;}stats=snapshot.data();return _context4.abrupt(\"return\",stats);case 8:case\"end\":return _context4.stop();}}},_callee4);}));return _getStats.apply(this,arguments);}export function getAds(){return _getAds.apply(this,arguments);}function _getAds(){_getAds=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){var db,adsRef,snapshot;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:db=firebase.firestore();adsRef=db.collection(\"data\").doc(\"ads\");_context5.next=4;return adsRef.get();case 4:snapshot=_context5.sent;if(snapshot.exists){}case 6:case\"end\":return _context5.stop();}}},_callee5);}));return _getAds.apply(this,arguments);}export function getResumes(_x4){return _getResumes.apply(this,arguments);}// adding employments\nfunction _getResumes(){_getResumes=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(userId){var resume,resumes,i,db,userRef,snapshot,employmentIndex,_loop,index,educationIndex,_loop2,_index,skillIndex,_loop3,_index2;return _regeneratorRuntime.wrap(function _callee6$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:resume={};resumes=[];i=0;db=firebase.firestore();userRef=db.collection('users').doc(userId).collection(\"resumes\").limit(3);_context9.next=7;return userRef.get();case 7:snapshot=_context9.sent;if(!snapshot.empty){_context9.next=10;break;}return _context9.abrupt(\"return\");case 10:snapshot.forEach(function(doc){resume.id=doc.id;// this is resume Id\nresume.item=doc.data();resume.employments=[];resume.educations=[];resume.skills=[];resumes[i]=resume;resume={};i++;});////////////////////// After getting all resumes we loop throu each resume Id  and get the emploments \nemploymentIndex=0;// this index will represent the index of each employment inside resumeObject\n_loop=/*#__PURE__*/_regeneratorRuntime.mark(function _loop(index){var db,employmentRef,employmentSnapshot;return _regeneratorRuntime.wrap(function _loop$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:db=firebase.firestore();employmentRef=db.collection('users').doc(userId).collection(\"resumes\").doc(resumes[index].id).collection(\"employments\");// Getting all employments inside the resume\n_context6.next=4;return employmentRef.get();case 4:employmentSnapshot=_context6.sent;if(!employmentSnapshot.empty){// Looping throu resumes if found\nemploymentSnapshot.forEach(function(value){// assigning data into our resumes[using the index of the target resume] array \nresumes[index].employments[employmentIndex]=value.data();resumes[index].employments[employmentIndex].employmentId=value.id;employmentIndex++;});}case 6:case\"end\":return _context6.stop();}}},_loop);});index=0;case 14:if(!(index<resumes.length)){_context9.next=19;break;}return _context9.delegateYield(_loop(index),\"t0\",16);case 16:index++;_context9.next=14;break;case 19:////////////////////// After getting all resumes we loop throu each resume Id  and get the eductions \neducationIndex=0;// this index will represent the index of each employment inside resumeObject\n_loop2=/*#__PURE__*/_regeneratorRuntime.mark(function _loop2(_index){var db,educationRef,educationSnapshot;return _regeneratorRuntime.wrap(function _loop2$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:db=firebase.firestore();educationRef=db.collection('users').doc(userId).collection(\"resumes\").doc(resumes[_index].id).collection(\"educations\");// Getting all employments inside the resume\n_context7.next=4;return educationRef.get();case 4:educationSnapshot=_context7.sent;if(!educationSnapshot.empty){// Looping throu resumes if found\n//   console.log(\"Found employments in\"+ resumes[index].id);\neducationSnapshot.forEach(function(value){// assigning data into our resumes[using the index of the target resume] array \nresumes[_index].educations[educationIndex]=value.data();resumes[_index].educations[educationIndex].educationId=value.id;// console.log( \"The id of the employment is\"+ resumes[index].employments[employmentIndex].employmentId)\neducationIndex++;});}case 6:case\"end\":return _context7.stop();}}},_loop2);});_index=0;case 22:if(!(_index<resumes.length)){_context9.next=27;break;}return _context9.delegateYield(_loop2(_index),\"t1\",24);case 24:_index++;_context9.next=22;break;case 27:////////////////////// After getting all resumes we loop throu each resume Id  and get the eductions \nskillIndex=0;// this index will represent the index of each employment inside resumeObject\n_loop3=/*#__PURE__*/_regeneratorRuntime.mark(function _loop3(_index2){var db,skillRef,skillSnapshot;return _regeneratorRuntime.wrap(function _loop3$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:db=firebase.firestore();skillRef=db.collection('users').doc(userId).collection(\"resumes\").doc(resumes[_index2].id).collection(\"skills\");// Getting all employments inside the resume\n_context8.next=4;return skillRef.get();case 4:skillSnapshot=_context8.sent;if(!skillSnapshot.empty){// Looping throu resumes if found\n//   console.log(\"Found employments in\"+ resumes[index].id);\nskillSnapshot.forEach(function(value){// assigning data into our resumes[using the index of the target resume] array \nresumes[_index2].skills[skillIndex]=value.data();resumes[_index2].skills[skillIndex].skillId=value.id;// console.log( \"The id of the employment is\"+ resumes[index].employments[employmentIndex].employmentId)\nskillIndex++;});}case 6:case\"end\":return _context8.stop();}}},_loop3);});_index2=0;case 30:if(!(_index2<resumes.length)){_context9.next=35;break;}return _context9.delegateYield(_loop3(_index2),\"t2\",32);case 32:_index2++;_context9.next=30;break;case 35:return _context9.abrupt(\"return\",resumes);case 36:case\"end\":return _context9.stop();}}},_callee6);}));return _getResumes.apply(this,arguments);}export function addEmployments(_x5,_x6,_x7){return _addEmployments.apply(this,arguments);}// adding Educations\nfunction _addEmployments(){_addEmployments=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(userId,resumeId,employmentsToAdd){var employmentsIds,employmentIndex,db,employmentRef,employmentSnapshot,res,index,_employmentRef;return _regeneratorRuntime.wrap(function _callee7$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:// getting all employments ids first \nemploymentsIds=[];employmentIndex=0;db=firebase.firestore();employmentRef=db.collection('users').doc(userId).collection(\"resumes\").doc(resumeId).collection(\"employments\");// Getting all employments inside the resume\n_context10.next=6;return employmentRef.get();case 6:employmentSnapshot=_context10.sent;if(!employmentSnapshot.empty){employmentSnapshot.forEach(function(value){employmentsIds[employmentIndex]=value.id;employmentIndex++;});}// Now we have the ids we can loop throu them and delete them to add new ones\nemploymentsIds.forEach(function(value){db.collection(\"users\").doc(userId).collection(\"resumes\").doc(resumeId).collection(\"employments\").doc(value).delete();});// Adding the new employments\nindex=0;case 10:if(!(index<employmentsToAdd.length)){_context10.next=22;break;}_employmentRef=db.collection('users').doc(userId).collection(\"resumes\").doc(resumeId).collection(\"employments\");if(!(employmentsToAdd[index]!==null)){_context10.next=18;break;}_context10.next=15;return _employmentRef.add({id:employmentsToAdd[index].id,jobTitle:employmentsToAdd[index].jobTitle,employer:employmentsToAdd[index].employer,begin:employmentsToAdd[index].begin,end:employmentsToAdd[index].end,description:employmentsToAdd[index].description});case 15:res=_context10.sent;_context10.next=19;break;case 18:console.log(\"kk\");case 19:index++;_context10.next=10;break;case 22:case\"end\":return _context10.stop();}}},_callee7);}));return _addEmployments.apply(this,arguments);}export function addEducations(_x8,_x9,_x10){return _addEducations.apply(this,arguments);}// adding Educations\nfunction _addEducations(){_addEducations=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8(userId,resumeId,educatiionsToAdd){var educationsIds,educationIndex,db,educationRef,educationSnapshot,res,index,_educationRef;return _regeneratorRuntime.wrap(function _callee8$(_context11){while(1){switch(_context11.prev=_context11.next){case 0:// getting all employments ids first \neducationsIds=[];educationIndex=0;db=firebase.firestore();educationRef=db.collection('users').doc(userId).collection(\"resumes\").doc(resumeId).collection(\"educations\");// Getting all employments inside the resume\n_context11.next=6;return educationRef.get();case 6:educationSnapshot=_context11.sent;if(!educationSnapshot.empty){educationSnapshot.forEach(function(value){educationsIds[educationIndex]=value.id;educationIndex++;});}// Now we have the ids we can loop throu them and delete them to add new ones\neducationsIds.forEach(function(value){db.collection(\"users\").doc(userId).collection(\"resumes\").doc(resumeId).collection(\"educations\").doc(value).delete();});// Adding the new employments\nindex=0;case 10:if(!(index<educatiionsToAdd.length)){_context11.next=22;break;}_educationRef=db.collection('users').doc(userId).collection(\"resumes\").doc(resumeId).collection(\"educations\");if(!(educatiionsToAdd[index]!==null)){_context11.next=18;break;}_context11.next=15;return _educationRef.add({id:educatiionsToAdd[index].id,school:educatiionsToAdd[index].school,started:educatiionsToAdd[index].started,finished:educatiionsToAdd[index].finished,degree:educatiionsToAdd[index].degree,description:educatiionsToAdd[index].description});case 15:res=_context11.sent;_context11.next=19;break;case 18:console.log();case 19:index++;_context11.next=10;break;case 22:case\"end\":return _context11.stop();}}},_callee8);}));return _addEducations.apply(this,arguments);}export function addSkills(_x11,_x12,_x13){return _addSkills.apply(this,arguments);}function _addSkills(){_addSkills=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee9(userId,resumeId,skillsToAdd){var skillsIds,skillIndex,db,skillRef,skillSnapshot,res,index,_skillRef;return _regeneratorRuntime.wrap(function _callee9$(_context12){while(1){switch(_context12.prev=_context12.next){case 0:// getting all employments ids first \nskillsIds=[];skillIndex=0;db=firebase.firestore();skillRef=db.collection('users').doc(userId).collection(\"resumes\").doc(resumeId).collection(\"skills\");// Getting all employments inside the resume\n_context12.next=6;return skillRef.get();case 6:skillSnapshot=_context12.sent;if(!skillSnapshot.empty){skillSnapshot.forEach(function(value){skillsIds[skillIndex]=value.id;skillIndex++;});}// Now we have the ids we can loop throu them and delete them to add new ones\nskillsIds.forEach(function(value){db.collection(\"users\").doc(userId).collection(\"resumes\").doc(resumeId).collection(\"skills\").doc(value).delete();});// Adding the new employments\nindex=0;case 10:if(!(index<skillsToAdd.length)){_context12.next=18;break;}_skillRef=db.collection('users').doc(userId).collection(\"resumes\").doc(resumeId).collection(\"skills\");_context12.next=14;return _skillRef.add({id:skillsToAdd[index].id,name:skillsToAdd[index].name,rating:skillsToAdd[index].rating});case 14:res=_context12.sent;case 15:index++;_context12.next=10;break;case 18:case\"end\":return _context12.stop();}}},_callee9);}));return _addSkills.apply(this,arguments);}export function InitialisationCheck(){return _InitialisationCheck.apply(this,arguments);}function _InitialisationCheck(){_InitialisationCheck=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee10(){var db,userRef,snapshot;return _regeneratorRuntime.wrap(function _callee10$(_context13){while(1){switch(_context13.prev=_context13.next){case 0:db=firebase.firestore();userRef=db.collection(\"data\").doc(\"id\");_context13.next=4;return userRef.get();case 4:snapshot=_context13.sent;if(!(snapshot.data()!=undefined)){_context13.next=9;break;}return _context13.abrupt(\"return\",snapshot.data().userId);case 9:return _context13.abrupt(\"return\",undefined);case 10:case\"end\":return _context13.stop();}}},_callee10);}));return _InitialisationCheck.apply(this,arguments);}export function setResumePropertyPerUser(_x14,_x15,_x16,_x17){return _setResumePropertyPerUser.apply(this,arguments);}function _setResumePropertyPerUser(){_setResumePropertyPerUser=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee11(userId,resumeId,propertyName,value){var db,user,res;return _regeneratorRuntime.wrap(function _callee11$(_context14){while(1){switch(_context14.prev=_context14.next){case 0:db=firebase.firestore();user=db.collection('users').doc(userId).collection(\"resumes\").doc(resumeId);_context14.t0=propertyName;_context14.next=_context14.t0===\"firstname\"?5:_context14.t0===\"lastname\"?9:_context14.t0===\"summary\"?13:_context14.t0===\"email\"?17:_context14.t0===\"phone\"?21:_context14.t0===\"occupation\"?25:_context14.t0===\"country\"?29:_context14.t0===\"city\"?33:_context14.t0===\"address\"?37:_context14.t0===\"postalcode\"?41:_context14.t0===\"dateofbirth\"?45:_context14.t0===\"drivinglicense\"?49:_context14.t0===\"nationality\"?53:_context14.t0===\"dateofbirth\"?57:61;break;case 5:_context14.next=7;return user.set({firstname:value},{merge:true});case 7:res=_context14.sent;return _context14.abrupt(\"break\",62);case 9:_context14.next=11;return user.set({lastname:value},{merge:true});case 11:res=_context14.sent;return _context14.abrupt(\"break\",62);case 13:_context14.next=15;return user.set({summary:value},{merge:true});case 15:res=_context14.sent;return _context14.abrupt(\"break\",62);case 17:_context14.next=19;return user.set({email:value},{merge:true});case 19:res=_context14.sent;return _context14.abrupt(\"break\",62);case 21:_context14.next=23;return user.set({phone:value},{merge:true});case 23:res=_context14.sent;return _context14.abrupt(\"break\",62);case 25:_context14.next=27;return user.set({occupation:value},{merge:true});case 27:res=_context14.sent;return _context14.abrupt(\"break\",62);case 29:_context14.next=31;return user.set({country:value},{merge:true});case 31:res=_context14.sent;return _context14.abrupt(\"break\",62);case 33:_context14.next=35;return user.set({city:value},{merge:true});case 35:res=_context14.sent;return _context14.abrupt(\"break\",62);case 37:_context14.next=39;return user.set({address:value},{merge:true});case 39:res=_context14.sent;return _context14.abrupt(\"break\",62);case 41:_context14.next=43;return user.set({postalcode:value},{merge:true});case 43:res=_context14.sent;return _context14.abrupt(\"break\",62);case 45:_context14.next=47;return user.set({dateofbirth:value},{merge:true});case 47:res=_context14.sent;return _context14.abrupt(\"break\",62);case 49:_context14.next=51;return user.set({drivinglicense:value},{merge:true});case 51:res=_context14.sent;return _context14.abrupt(\"break\",62);case 53:_context14.next=55;return user.set({dateofbirth:value},{merge:true});case 55:res=_context14.sent;return _context14.abrupt(\"break\",62);case 57:_context14.next=59;return user.set({dateofbirth:value},{merge:true});case 59:res=_context14.sent;return _context14.abrupt(\"break\",62);case 61:return _context14.abrupt(\"break\",62);case 62:case\"end\":return _context14.stop();}}},_callee11);}));return _setResumePropertyPerUser.apply(this,arguments);}export default addResume;","map":null,"metadata":{},"sourceType":"module"}